#include <iostream>
#include <string>
#include "InputParameter.h"
#include "optimization.h"
#include "paramedeterm.h"

InputParameter *inputParameter;

int main(int argc, char *argv[]) {

    std::string inputFileName;
    if (argc == 1) {
        inputFileName = "../nvsim.cfg";
        std::cout << "Default configuration file (nvsim.cfg) is loaded" << std::endl;
    } else if (argc == 2) {
        inputFileName = argv[1];
        std::cout << "User-defined configuration file (" << inputFileName << ") is loaded" << std::endl;
    } else {
        std::cout << "[NVSIM Error]: Please use the correct format as follows" << std::endl;
        std::cout << "  Use the default configuration: " << argv[0] << std::endl;
        std::cout << "  Use the customized configuration: " << argv[0] << " <.cfg file>" << std::endl;
        exit(-1);
    }
    std::cout << std::endl;

    std::cout<< "Start loading hardware configure and data statistics" << std::endl;
    inputParameter = new InputParameter();
    inputParameter->ReadInputParameterFromFile(inputFileName);
    inputParameter->PrintInputParameter();

    //parameter determine
    Paramedeterm parameDetermine;
    parameDetermine.init(*inputParameter);
    parameDetermine.determineparaforpim(*inputParameter);

    //optimization determine
    bdoptimization optimize;
    optimize.bdoptiminit(inputParameter->originbdnum);
    optimize.bdinforead(inputFileName);
    optimize.boundrecommend(inputParameter->dataoriginalvolume);


    return 0;
}
